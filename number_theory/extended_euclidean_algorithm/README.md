## 扩展欧几里得算法（extended Euclidean algorithm）的证明与实现

首先，我们还是回顾一下欧几里得算法相关的一些基本概念的定义：

### 整除

**定义** 如果$a$和$b$为整数且$a \neq 0$，我们说$a$**整除**$b$是指存在整数$c$使得$b = a \cdot c$。如果$a$整除$b$，我们还称$a$**是**$b$**的一个因子**，且称$b$**是**$a$**的倍数**。

如果$a$整除$b$，则将其记为$a \mid b$，如果$a$不能整除$b$，则记其为$a \nmid b$。

### 最大公因子

**定义** 不全为零的整数$a$和$b$的最大公因子是指能够同时整除$a$和$b$的最大整数。

$a$和$b$的最大公因子记作$(a, b)$。有时也记作$gcd(a, b)$。

注意当$n$为正整数时，$(0, n) = (n, 0) = n$。

虽然所有的正整数都能够整除$0$，我们还是定义$(0, 0) = 0$。这样可以确保关于最大公因子的相关结论在所有情况下均成立。

### 欧几里得算法

**定理** 令整数$r_0 = a$，$r_1 = b$满足$a \ge b > 0$，
如果连续做带余除法得到$r_j = r_{j+1} \cdot q_{j+1} + r_{j+2}$，
且$0 < r_{j+2}  < r_{j+1}$（$j = 0, 1, 2, \cdots, n-2$），$r_{n+1} = 0$，
那么$(a, b) = r_n$，它是最后一个非零余数。

- - -

然后我们介绍一下，用线性组合的方法来表示最大公因数的理论支持：

**贝祖定理（裴蜀定理）** 如果$a$和$b$为正整数，且$(a, b) = d$，那么对于任意的整数$x$和$y$，
$x \cdot a + y \cdot b$都一定是d的倍数，特别地，一定存在整数$s$和$t$，
使$s \cdot a + t \cdot b = d$成立。

**定义** 如果$a$和$b$为正整数，则使得$(a, b) = s \cdot a + t \cdot b$的整数$s$和$t$，
称为$a$和$b$的贝祖系数。等式$(a, b) = s \cdot a + t \cdot b$称为贝祖恒等式。

根据贝祖定理，我们知道任意两个正整数的最大公约数可以表示为这两个整数的整系数的线性组合。
接下来我们会给出两种方法，用于找出两个正整数的线性组合以使之等于其最大公约数。

- - -

第一种方法要对欧几里得算法的除法步骤做反向处理，所以需要将欧几里得算法的步骤正反向各走一遍。
我们用一个例子来解释这种工作方法的工作原理，并给出python语言的实现。

**例子1** 通过欧几里得算法的反向处理，试把$(252, 198) = 18$表示为$252$和$198$的线性组合。

首先我们先回顾一下用欧几里得算法求$(252, 198)$的步骤：
$$
\begin{aligned}
252 & = 198 \times 1 + 54 \\
198 & = 54 \times 3 +36 \\
 54 & = 36 \times 1 + 18 \\
 36 & = 18 \times 2
\end{aligned}
$$
我们将这些步骤总结在下表中：

| $j$  | $r_j$ | $r_{j+1}$ | $q_{j+1}$ | $r_{j+2}$ |
| ---- | ----- | --------- | --------- | --------- |
| 0    | 252   | 198       | 1         | 54        |
| 1    | 198   | 54        | 3         | 36        |
| 2    | 54    | 36        | 1         | 18        |
| 3    | 36    | 18        | 2         | 0         |

最后一个非零除数（在最后一列倒数第二行的那个数）就是252和198的最大公因子。因此$(252, 198) = 18$

观察用欧几里得算法求$(252, 198)$的倒数第二步，
$$
18 = 54 - 36 \times 1 
$$
它的前面一步是
$$
36 = 198 - 54 \times 3
$$
这意味着
$$
18 = 54 - (198 - 54 \times 3) \times 1 = 54 \times 4 - 198 \times 1
$$
同样，由第一步，我们得
$$
54 = 252 - 198 \times 1 
$$
因此
$$
18 = (252 - 198 \times 1) \times 4 - 198 \times 1 = 252 \times 4 - 198 \times 5 = 4 \times 252 - 5 \times 198
$$
最后一个等式将$18 = (252, 198)$写成了$252$, $198$的线性组合的形式。

一般地，为了知晓如何使用$a$, $b$的线性组合来表示它们的最大公因数$d = (a, b)$
