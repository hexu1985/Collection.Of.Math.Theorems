## 扩展欧几里得算法（extended Euclidean algorithm）的证明与实现

**贝祖定理（裴蜀定理）** 如果$a$和$b$为正整数，且$\gcd(a,b) = d$，那么对于任意的整数$x$和$y$，
$x \cdot a + y \cdot b$都一定是d的倍数，特别地，一定存在整数$s$和$t$，
使$s \cdot a + t \cdot b = d$成立。

**定义** 如果$a$和$b$为正整数，则使得$\gcd(a,b) = s \cdot a + t \cdot b$的整数$s$和$t$，
称为$a$和$b$的贝祖系数。等式$\gcd(a,b) = s \cdot a + t \cdot b$称为贝祖恒等式。

根据贝祖定理，我们知道任意两个正整数的最大公约数可以表示为这两个整数的整系数的线性组合。
接下来我们会给出两种方法，用于找出两个正整数的线性组合以使之等于其最大公约数。

第一种方法要对欧几里得算法的除法步骤做反向处理，所以需要将欧几里得算法的步骤正反向各走一遍。
我们用一个例子来解释这种工作方法的工作原理，并给出python语言的实现。

**例子1** 通过欧几里得算法的反向处理，试把$(252, 198) = 18$表示为$252$和$198$的线性组合。

首先我们先回顾一下用欧几里得算法求$(252, 198)$的步骤：
$$
\begin{aligned}
252 & = 198 \times 1 + 54 \\
198 & = 54 \times 3 +36 \\
 54 & = 36 \times 1 + 18 \\
 36 & = 18 \times 2
\end{aligned}
$$
我们将这些步骤总结在下表中：

| $j$  | $r_j$ | $r_{j+1}$ | $q_{j+1}$ | $r_{j+2}$ |
| ---- | ----- | --------- | --------- | --------- |
| 0    | 252   | 198       | 1         | 54        |
| 1    | 198   | 54        | 3         | 36        |
| 2    | 54    | 36        | 1         | 18        |
| 3    | 36    | 18        | 2         | 0         |

最后一个非零除数（在最后一列倒数第二行的那个数）就是252和198的最大公因子。因此$(252, 198) = 18$

观察用欧几里得算法求$(252, 198)$的倒数第二步，
$$
18 = 54 - 36 \times 1 
$$
它的前面一步是
$$
36 = 198 - 54 \times 3
$$
这意味着
$$
18 = 54 - (198 - 54 \times 3) \times 1 = 54 \times 4 - 198 \times 1
$$
同样，由第一步，我们得
$$
54 = 252 - 198 \times 1 
$$
因此
$$
18 = (252 - 198 \times 1) \times 4 - 198 \times 1 = 252 \times 4 - 198 \times 5 = 4 \times 252 - 5 \times 198
$$
最后一个等式将$18 = (252, 198)$写成了$252$, $198$的线性组合的形式。
